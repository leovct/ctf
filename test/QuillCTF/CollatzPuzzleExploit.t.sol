// SPDX-License-Identifier: GPL-3.0
pragma solidity 0.8.19;

import '../../src/QuillCTF/CollatzPuzzle.sol';
import { HuffDeployer } from '@foundry-huff/HuffDeployer.sol';
import '@forge-std/Test.sol';
import '@forge-std/console2.sol';

interface CollatzHelper {
  function collatzIteration(uint256) external pure returns (uint256);
}

contract CollatzPuzzleExploit is Test {
  CollatzPuzzle collatzPuzzle;
  CollatzHelper collatzHelper;

  function setUp() public {
    collatzPuzzle = new CollatzPuzzle();
    collatzHelper = CollatzHelper(
      HuffDeployer.deploy('../test/QuillCTF/CollatzHelper')
    );
  }

  function testExploit() public {
    assertTrue(collatzPuzzle.callMe(address(collatzHelper)));
    console2.log('Contracts return the same result');
  }
}
